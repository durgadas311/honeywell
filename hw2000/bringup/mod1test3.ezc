00000* MOD1 PROGRAM TO TEST READING VOLUME DIRECTORY
00000         PROG  MOD1T3
00000         ORG   1340
00000         ADMODE4
00000         MAC   MOD1MSIO
00000*
00000L        MIOC  A
00000*
00000C F1     MCA   A,DEVTAB,
00000C        10    RECD2,,MOVE,RECD1
00000C        20    *VOLNAMES*,
00000C        31    00,
00000C        40    VEXIT,
00000L        43    DEXIT,
00000* LOOK FOR ERRORS ON CONSOLE
00000*
00000  START  CAM   60
00000*
00000L        MSOPENF1,IN
00000C        MUCA  F1,VOLNM,VNM,
00000L              VOLSN,VSN
00000         PDT   VOL,12,02,01    PRINT VOLUME INFO
00000         PCB   *,12,02,00
00000*
00000L NEXT   MSGET F1,
00000         BCE   NEXT,RECD1,77
00000         BA    ONE,CNT
00000         MCW   RECD1+9,FNAM
00000         PDT   FLIST,12,02,01    PRINT RECORD
00000         PCB   *,12,02,00
00000         B     NEXT
00000*
00000L DONE   MSCLOSF1,
00000         EXT   CNT,CNT
00000         BCT   NONE,60
00000         B     DECOUT
00000         PDT   NUM,10,02,01
00000         PCB   *,10,02,00
00000         B     (164)      PROGRAM EXIT
00000  NONE   PDT   NOF,10,02,01
00000         PCB   *,10,02,00
00000         B     (164)      PROGRAM EXIT
00000*
00000  ABORT  DCW   #1C40
00000  CONT   DCW   #1C10
00000  VEXITC DCW   #1B0
00000  VEXIT  SCR   VXITZ,70
00000         BCE   OPEN,VEXITC,01
00000         EXM   ABORT,VEXITC,01
00000         B     VXXIT
00000  OPEN   EXM   CONT,VEXITC,01
00000*
00000* TODO: COMPUTE BUFFERS FROM *VOLDESCR* DATA
00000*
00000         PDT   OPN,10,02,01      DEBUG ONLY
00000         PCB   *,10,02,00
00000  VXXIT  NOP
00000   VXITZ B     0
00000*
00000  DEXITC DCW   #1B0
00000  DEXIT  SCR   DXITZ,70
00000         BCE   DONE,DEXITC,01    EOF
00000         EXM   ABORT,DEXITC,01
00000   DXITZ B     0
00000*
00000* ROUTINE TO CONVERT CNT TO DECIMAL
00000* AND FORMAT INTO SUMMARY MESSAGE
00000  B99    DCW   #2B100
00000  D99    DCW   +100
00000  B9     DCW   #1B10
00000  D9     DCW   +10
00000  DSUM   DCW   +000
00000  DFMT   DCW   @  0@
00000  DECOUT SCR   DECZ,70
00000         BS    DSUM,DSUM
00000  DEC0   C     B99,CNT
00000         BCT   DEC1,41
00000         BS    B99,CNT
00000         A     D99,DSUM
00000         B     DEC0
00000  DEC1   C     B9,CNT
00000         BCT   DEC2,41
00000         BS    B9,CNT
00000         A     D9,DSUM
00000         B     DEC1
00000  DEC2   A     CNT,DSUM
00000         LCA   DFMT,(DOUT)
00000         MCE   DSUM,(DOUT)
00000   DECZ  B     0
00000*
00000  CNT    DCW   #2B0
00000  ONE    DCW   #1B1
00000*
00000  DEVTAB RESV  0
00000         DCW   #3C040000     PCA, LUN, 00
00000 L       DCW   #1B0
00000*
00000   DOUT  DSA   NUM+2
00000 F OPN   DC    @OPEN CALLOUT @
00000  NUM    DCW   #1B0    3RD CHAR OF NUMBER
00000 F NOF   DC    @NO FILES @
00000   VOL   DC    @VOLUME @
00000  VOLNM  DC    #6A
00000         DC    @ S/N @
00000  VOLSN  DC    #6A
00000         DC    @ CONTAINS:@
00000 L       DCW   #1B0
00000*
00000  FLIST  RESV  0
00000  FNAM   DCW   #10A
00000 L       DCW   #1B0
00000*
00000* TODO: COMPUTE THESE IN OPEN EXIT
00000   RECD2 RESV, 768      BLOCK BUFFER
00000 L       DCW   #1A
00000 L       DCW   #1A
00000 L       DCW   #1A
00000*
00000   RECD1 RESV, 30       ITEM BUFFER
00000 L       DCW   #1A
00000*
00000         END   START
